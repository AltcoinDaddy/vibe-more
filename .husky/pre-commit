#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "🔍 Running pre-commit legacy syntax validation..."

# Run production code scan to check for legacy patterns
npx tsx lib/migration/run-production-scan.ts

# Check exit code
if [ $? -ne 0 ]; then
  echo "❌ Pre-commit hook failed: Legacy Cadence patterns detected!"
  echo "Please fix the legacy patterns before committing."
  echo "Run 'npx tsx lib/migration/run-production-scan.ts' for details."
  exit 1
fi

echo "✅ Pre-commit validation passed: No legacy patterns detected."